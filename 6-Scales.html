<!DOCTYPE>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>D3 Demos</title>
    <script type="text/javascript" src="d3/d3.v2.js"></script>
  </head>
  <body>
    <style type="text/css">
      .axis path,
      .axis line {
        fill: none;
        stroke: black;
        shape-rendering: crispEdges;
      }
      
      .axis text {
        font-family: sans-serif;
        font-size: 11px;
      }
    </style>
    <script type="text/javascript">
// In this example, we will see how to use
// domains and ranges, and x and y axis

      var svg = d3.select('body').append("svg"),
          w = 300,
          h = 300,
          i = -1,
          margin = 20;

      svg.attr({
        width: w,
        height: h
      }).style("border", "2px solid #f00"); 

      var dataset = [
        {"time": ++i, "value": 21},
        {"time": ++i, "value": 101},
        {"time": ++i, "value": 30},
        {"time": ++i, "value": 71}
      ];
//declare the scales
      var x = d3.scale.linear()
//use the dataset.length for max x
          .domain([0, dataset.length])
          .range([margin, w-margin*2]);

// supply a function to determine max
      var y = d3.scale.linear()
          .domain([0, d3.max(dataset, function(d) {
            return d.value;
          })])
          .rangeRound([h-margin, margin]);    

      var rects = svg.selectAll("rect").data(dataset);

      rects
        .enter()
        .append("rect")
          .attr({
            height: function(d) { return d.value; },
            // height: function(d) { return h-margin-y(d.value); },
            y: function(d) { return h-d.value },
            // y: function(d) { return y(d.value); },
            x: function(d) { return d.time*25 },
            // x: function(d) { return x(d.time); },
            width: 20,
          });

      var texts = svg.selectAll("text")
        .data(dataset, function(d) { 
          return d.time; 
        });
        
      texts.enter()
        .append("text")
          .attr({
            x: function(d) { return d.time*25+10 },
            // x: function(d) { return x(d.time)+10 },
            y: function(d) { return 300-d.value+10 },
            // y: function(d) { return y(d.value)+10 },
            fill: "white",
            "font-family": "sans-serif",
            "font-size": 11,
            "text-anchor": "middle"
          })
          .text(function(d) {return d.value;}); 

      // var xAxis = d3.svg.axis()
      //                   .scale(x) 
      //                   .orient("bottom")
      //                   .tickPadding(4);

      // svg.append("g")
      //     .attr("class", "axis")
      //     .attr("transform", "translate(0," + (h-margin) + ")")
      //     .call(xAxis);
    </script>
  </body>
</html>